<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Save The Forest</title>

  <!-- Meta / Icons (optional: add your own assets) -->
  <meta name="theme-color" content="#319175" />
  <link rel="icon" href="/assets/ramo-favicon.png" />

  <!-- Styles -->
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <noscript>
    <div class="card" style="margin:16px">This game requires JavaScript to run.</div>
  </noscript>

  <!-- Header / HUD -->
  <header>
    <div class="title">Save The Forest<span id="season">Year 1 · Period 1</span>
    </div>
    <div class="hud" role="status" aria-live="polite">
      <span class="pill" id="pillForest">🌲 Forest: <b id="statForest">-</b></span>
      <span class="pill" id="pillFood">🌾 Food: <b id="statFood">-</b></span>
      <span class="pill" id="pillComm">💰 Community: <b id="statComm">0</b></span>
      <span class="pill">💼 Treasury: <b id="statMoney">50</b></span>
      <span class="pill">🏛️ Gov: <b id="statGov">3</b></span>
      <span class="pill">🫱 Social: <b id="statSoc">3</b></span>
      <span class="pill" id="pillER">🧾 ER: <b id="statER">off</b></span>
    </div>
  </header>

<!-- App -->
  <main class="app" id="app" role="main">
    <!-- Left Sidebar -->
    <aside class="left">
      <section class="card" aria-labelledby="sim-title">
        <h3 id="sim-title">⚙️ Simulation</h3>
        <label for="ticksPer">Ticks / period</label>
        <div>
          <input id="ticksPer" type="range" min="4" max="20" value="8" aria-describedby="ticksLbl" />
          <span id="ticksLbl">8</span>
        </div>
        <label for="spawnRate">Spawn rate (👶)</label>
        <div>
          <input id="spawnRate" type="range" min="0" max="10" value="2" aria-describedby="spawnLbl" />
          <span id="spawnLbl">2</span>
        </div>
        <div class="actions" aria-label="Simulation actions">
          <button type="button" class="btn" id="btnTick">▶️ Tick</button>
          <button type="button" class="btn good" id="btnRun">⏩ Run period</button>
          <button type="button" class="btn warn" id="btnCouncil">🗳️ Open Council</button>
        </div>
      </section>

      <section class="card" aria-labelledby="tools-title">
        <h3 id="tools-title">🧰 Click Tools (each costs capital)</h3>
        <div class="tool-list">
          <button type="button" class="btn good" id="toolFirebreak" aria-pressed="false">🚧 Toggle Firebreak (💰1/tile)</button>
          <button type="button" class="btn good" id="toolReplant" aria-pressed="false">🌱 Replant Cleared (💰2/tile)</button>
          <button type="button" class="btn good" id="toolGuardian">🧑‍🌱 Spawn Guardian (💰10 → +1🫱)</button>
          <button type="button" class="btn" id="toolProtect" aria-pressed="false">🛡️ Protect Tile (🫱2 upfront + 💰1/period)</button>
          <button type="button" class="btn" id="toolInspect" aria-pressed="false">🔎 Inspect</button>
        </div>
        <p class="hint">Click a tool to toggle it <em>on</em>. Click again to turn it off.</p>
      </section>

      <section class="card" aria-labelledby="legend-title">
        <h3 id="legend-title">📜 Legend</h3>
        <div class="legend" aria-label="Legend">
          <span>🌲 Forest</span><span>🪵 Edge</span><span>🟫 Cleared</span><span>🌾 Farm</span><span>🔥 Char</span><span>🚧 Firebreak</span>
          <span>🏘️ Village</span><span>🏠 Hut</span><span>🌱 Replant</span><span>🧑‍🌱 Guardian</span><span>🛡️ Protected</span><span>🔥 Fire (wild)</span>
        </div>
      </section>

      <section class="card" aria-labelledby="goals-title">
        <h3 id="goals-title">🎯 Goals</h3>
        <p class="hint">Lose if 🌲 &lt;20% or 🌾 &lt;30% for 3 consecutive periods. Win: keep 🌲 &gt;40% after 10 years with growing 💰 community.</p>
      </section>

      <section class="card" aria-labelledby="tests-title">
        <h3 id="tests-title">🧪 Tests</h3>
        <div class="hint" id="testbar">Will run on load…</div>
      </section>
    </aside>

    <!-- Center + Right -->
    <section class="right">
      <div class="boardWrap">
        <div id="board" class="board" role="grid" aria-label="Game board"></div>

        <!-- Fixed right panel -->
        <div class="sidepanel">
          <section class="card" aria-labelledby="summary-title">
            <h3 id="summary-title">📈 Period Summary</h3>
            <div id="summary">—</div>
          </section>

          <section class="card" aria-labelledby="trends-title">
            <h3 id="trends-title">📊 Trends (last 80 periods)</h3>
            <canvas id="trend" width="520" height="180" aria-label="Trends chart"></canvas>
            <p class="hint">Tracks: Forest %, Food %, Community money, Population.</p>
          </section>

          <section class="card" aria-labelledby="log-title">
            <h3 id="log-title">🧾 Emoji Step Log</h3>
            <div class="log" id="log" aria-live="polite"></div>
          </section>
        </div>
      </div>
    </section>
  </main>

  <!-- Council Modal -->
  <div class="modal" id="councilModal" role="dialog" aria-modal="true" aria-labelledby="council-title">
    <div class="dialog">
      <h2 id="council-title">🏛️ Period Council — Interventions (spend capitals)</h2>

      <div class="council">
        <div class="card" style="margin:0">
          <b>📜 Land Tenure</b>
          <div class="hint">Cost: 🏛️2 + 🫱1. Enables consolidation & value chains.</div>
          <button type="button" class="btn" data-action="tenure">Launch</button>
        </div>
        <div class="card" style="margin:0">
          <b>🌾 Value Chains</b>
          <div class="hint">Cost: 🫱2 + 💰25. Convert 3 👨‍🌾 to high-value farmers.</div>
          <button type="button" class="btn" data-action="valueChains">Introduce</button>
        </div>
        <div class="card" style="margin:0">
          <b>🌾 Consolidate Farms</b>
          <div class="hint">Cost: 🫱2 + 🏛️1. Requires Tenure.</div>
          <button type="button" class="btn" data-action="consolidate">Apply</button>
        </div>
        <div class="card" style="margin:0">
          <b>🧑‍🌱 Guardians (x3)</b>
          <div class="hint">Cost: 💰40. Patrol, replant, fight fires, deter.</div>
          <button type="button" class="btn" data-action="guardians">Hire</button>
        </div>
        <div class="card" style="margin:0">
          <b>🚧 Firebreak Network</b>
          <div class="hint">Cost: 💰25 + 🫱1. Slows edge/fire spread.</div>
          <button type="button" class="btn" data-action="firebreaks">Build</button>
        </div>
        <div class="card" style="margin:0">
          <b>💵 Pay-to-Not-Cut (ER)</b>
          <div class="hint">Cost: 💰20. 30% fewer cuts next period. Earn 10💰 (+1🫱).</div>
          <button type="button" class="btn" data-action="er">Start</button>
        </div>
        <div class="card" style="margin:0">
          <b>🌱 Replanting Drive</b>
          <div class="hint">Cost: 💰30. Convert 8 🟫 → 🌱 → 🌲 (+15💰 later).</div>
          <button type="button" class="btn" data-action="replantDrive">Plant</button>
        </div>
        <div class="card" style="margin:0">
          <b>🧑‍💼 Entrepreneur Shift</b>
          <div class="hint">Cost: 💰20. 1 🧑‍💼 funds guardians instead of cutters.</div>
          <button type="button" class="btn" data-action="entShift">Persuade</button>
        </div>
      </div>

      <div class="actions">
        <button type="button" class="btn" id="closeCouncil">Done</button>
      </div>
    </div>
  </div>

  <script src="/game.js" defer></script>
</body>
</html>
